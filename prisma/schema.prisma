// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Guild {
  id    String       @id @unique
  cases Moderation[]
}

enum CaseAction {
  Warn
  Timeout
  Kick
  Softban
}

model Moderation {
  caseId          Int       @id @unique
  createdAt       DateTime     @default(now())
  duration        Int?
  guildId         String
  guild           Guild        @relation(fields: [guildId], references: [id])
  moderatorId     String       @default("934121887829737562") // default = sentry bot id
  reason          String /// @encrypted
  modLogMessageId String?
  action          CaseAction
  userId          String
  caseReferenceId Int?
  caseReference   Moderation?  @relation("CaseReference", fields: [caseReferenceId], references: [caseId])
  references      Moderation[] @relation("CaseReference")
  userName        String /// Username at time of punishment
}
